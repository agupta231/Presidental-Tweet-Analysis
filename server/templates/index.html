<!DOCTYPE html>
<html lang='en'>
<head>
	<title>Presidential Tweet Anaysis</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script
		src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
</head>
<body>
    <div class="container marketing">
    <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7">
            <h2 class="featurette-heading">Introduction<span class="text-muted"> Analyzing Trump Tweets.</span></h2>
            <p class="lead">By analyzing aspects of Donald Trumpâ€™s tweets you may be able to see trends in word use, phrase use, and other aspects to be able to predict whether or not a given tweet came from Donald Trump.
      </p>
          </div>
          <div class="col-md-5">
              <img src = "/static/images/TrumpTweeting.png" width = "436" height = "244">
          </div>
        </div>

        <hr class="featurette-divider">

        <div class="row featurette">
          <div class="col-md-7">
            <img src = "/static/images/TrumpUncommonWords.svg" width = "700" height = "500">
            </div>
          <div class="col-md-5">
            <h2 class="featurette-heading">Trump's most common words<span class="text-muted">See for yourself.</span></h2>
            <p class="lead">Donec ullamcorper nulla non metus auctor fringilla. Vestibulum id ligula porta felis euismod semper. Praesent commodo cursus magna, vel scelerisque nisl consectetur. Fusce dapibus, tellus ac cursus commodo.</p>
          </div>
        </div>



        <hr class="featurette-divider">
        <div>
          <h2>{Trump Tweet} <span class="text-muted">|!{Trump Tweeet}</span></h2>
          <p class="lead">Want to figure out whether or not Trump tweeted something out? Enter the text below to predict if it came from our commander-in-chief.</p>
        </div>

        <div class="col-md-7">            
          <textarea rows="4" cols="80" id="text"></textarea>
          <input type="submit" value="Analyze" onclick="getData()">
        </div>
        <div class="col-md-5">
            <h3 id ="confText">/h3>
            <img id="confImg" width= "400" height = "300"></img>
        </div>
        <hr class="featurette-divider">

      <div id="chartContainer"></div>

        </div>
</body>
</html>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script>
function loadChart(d){

  var chart = new CanvasJS.Chart("chartContainer", {
    animationEnabled: true,
    
    title:{
      text:"Fortune 500 Companies by Country"
    },
    axisX:{
      interval: 1
    },
    axisY2:{
      interlacedColor: "rgba(1,77,101,.2)",
      gridColor: "rgba(1,77,101,.1)",
      title: "Number of Companies"
    },
    data: [{
      type: "bar",
      name: "companies",
      axisYType: "secondary",
      color: "#014D65",
      dataPoints: [
        { y: 3, label: "Sweden" },
        { y: 7, label: "Taiwan" },
        { y: 5, label: "Russia" },
        { y: 9, label: "Spain" },
        { y: 7, label: "Brazil" },
        { y: 7, label: "India" },
        { y: 9, label: "Italy" },
        { y: 8, label: "Australia" },
        { y: 11, label: "Canada" },
        { y: 15, label: "South Korea" },
        { y: 12, label: "Netherlands" },
        { y: 15, label: "Switzerland" },
        { y: 25, label: "Britain" },
        { y: 28, label: "Germany" },
        { y: 29, label: "France" },
        { y: 52, label: "Japan" },
        { y: 103, label: "China" },
        { y: 134, label: "US" }
      ]
    }]
  });
  chart.render();
}
getData()

function getData(){
    submitURL = "/predict"
    var postReq = {};
    postReq["sentence"] = "i dont know"//document.getElementById("text").value;
    console.log("JS of req:" + JSON.stringify(postReq));
    var xhr = new XMLHttpRequest();
    xhr.open("POST", submitURL, true);
    xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
    console.log(submitURL);
    xhr.send(JSON.stringify(postReq));
    console.log(xhr);
    xhr.onloadend = function () {
        console.log(xhr);
        if (xhr.readyState == XMLHttpRequest.DONE) {
            console.log(xhr.responseText);
                currentData = JSON.parse(xhr.responseText.replace(/\'/g,"\""))
                console.log(currentData)
                conf = currentData["trump_confidence"]
                if(conf > .6){
                  document.getElementById("confText").innerHTML = "It's probably a Trump Tweet"
                  //document.getElementById("confImg").src = "/static/images/TrumpThumbsUp.png";

                }
                else if(conf < .4){
                  document.getElementById("confText").innerHTML = "It's probably not a Trump Tweet"
                  //document.getElementById("confImg").src = "/static/images/TrumpThumbsDown.png";

                }
                else{
                  document.getElementById("confText").innerHTML = "Not too sure"
                  //document.getElementById("confImg").src = "/static/images/ConfusedTrump.png";

                }




                loadChart(currentData["word_confidences"])
       } else {
            alert("Did not get response, server is down?")
        }
    }
}



</script>

